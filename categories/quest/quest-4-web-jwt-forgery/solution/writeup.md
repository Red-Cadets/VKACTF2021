## Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»Ñ‘Ñ‚Ð°Ð¼Ð¸

| Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ðµ | ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ | ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ | Ð¡Ð»Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ |
| :------ | ---- | ---- | ---- |
| VKACTF 2021 | Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»Ñ‘Ñ‚Ð°Ð¼Ð¸ | Web | easy |

### ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ

> ÐÐ²Ñ‚Ð¾Ñ€: [ ð•‚ð•£ð•’ð•¦ð•¤ð•– ]
>
> Ð Ð°Ð´Ð¾ÑÑ‚ÑŒ Ð±Ñ‹ÑÑ‚Ñ€Ð¾ ÑÐ¼ÐµÐ½Ð¸Ð»Ð°ÑÑŒ Ð³Ñ€ÑƒÑÑ‚ÑŒÑŽ, Ñ‚ÐµÐ¿ÐµÑ€ÑŒ ÑÑ‚Ð¾ÑÐ» Ð²Ð¾Ð¿Ñ€Ð¾Ñ, ÐºÐ°Ðº, Ð½Ðµ Ð¸Ð¼ÐµÑ ÐºÐ¾ÑÐ¼Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ ÐºÐ¾Ñ€Ð°Ð±Ð»Ñ, Ð´Ð¾Ð±Ñ€Ð°Ñ‚ÑŒÑÑ Ð´Ð¾ ÐŸÐ»ÑƒÑ‚Ð¾Ð½Ð°. Ð”Ñ€ÑƒÐ³ Ð¾Ñ‚Ñ†Ð° ÑÑ€Ð°Ð·Ñƒ ÑÐ¼ÐµÐºÐ½ÑƒÐ» Ð¸Ð·-Ð·Ð° Ñ‡ÐµÐ³Ð¾ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð° Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ñ Ð¸ Ð¿Ñ€Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð¸Ð»: 
>
> â€” Ð Ð°Ð´Ð¸ Ñ‚Ð°ÐºÐ¾Ð³Ð¾ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐºÐ°, ÐºÐ°Ðº Ñ‚Ð²Ð¾Ð¹ Ð¾Ñ‚ÐµÑ†, Ð¸ ÑÑ‚Ð¾Ð¸Ñ‚ Ð´Ð¾ÑÑ‚Ð°Ñ‚ÑŒ Ð¼Ð¾Ð¹ ÑÑ‚Ð°Ñ€ÐµÐ½ÑŒÐºÐ¸Ð¹ ÐºÐ¾ÑÐ¼Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ ÐºÐ¾Ñ€Ð°Ð±Ð»ÑŒ, Ñ‚Ð¾Ð¿Ð»Ð¸Ð²Ð° Ð² Ð½Ñ‘Ð¼ Ñ…Ð²Ð°Ñ‚Ð¸Ñ‚ Ð¸ Ð½Ð° Ð¿Ð¾Ð»Ñ‘Ñ‚ Ð´Ð¾ ÐŸÐ»ÑƒÑ‚Ð¾Ð½Ð°, Ð¸ Ð½Ð° Ð¿Ð¾Ð»Ñ‘Ñ‚ Ð´Ð¾ Ð´Ð¾Ð¼Ð°. Ð¢Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÑ‚ÑŒ Ð¾Ð´Ð½Ð° Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð°, Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ñ‚Ð°Ðº Ñ ÐœÐ°Ñ€ÑÐ° Ð½ÐµÐ»ÑŒÐ·Ñ ÑƒÐ»ÐµÑ‚ÐµÑ‚ÑŒ. ÐÑƒÐ¶Ð½Ð¾ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ð¾Ðµ Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ, Ð° Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ ÐµÐ³Ð¾ Ð¾Ñ‡ÐµÐ½ÑŒ Ñ‚Ñ€ÑƒÐ´Ð½Ð¾.
>
> â€” ÐÐ¾ Ð²ÐµÐ´ÑŒ ÐºÐ°Ðº-Ñ‚Ð¾ Ð¶Ðµ Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ð¾Ð´Ð´ÐµÐ»Ð°Ñ‚ÑŒ Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ?
>
> â€” ÐÐµ Ð·Ð½Ð°ÑŽ, Ñ‚ÐµÐ±Ðµ Ð½ÑƒÐ¶Ð½Ð¾ Ð¿Ñ€Ð¾Ð½Ð¸ÐºÐ½ÑƒÑ‚ÑŒ Ðº Ð¾Ð´Ð½Ð¾Ð¼Ñƒ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÑÑŽÑ‰ÐµÐ¼Ñƒ Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð»Ñƒ. Ð¯ Ñ‚ÐµÐ±Ñ Ñ‚ÑƒÐ´Ð° Ð¾Ñ‚Ð²ÐµÐ´Ñƒ Ð¸ Ð´Ð°Ð¼ Ñ‚ÐµÐ±Ðµ ÐµÑ‰Ñ‘ Ð²ÑÑŽ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¿Ð¾ ÐºÐ¾Ñ€Ð°Ð±Ð»ÑŽ, Ð²ÑÑ‘, Ñ‡Ñ‚Ð¾ Ð²ÐµÑ€Ð¾ÑÑ‚Ð½Ð¾ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ð¾Ð½Ð°Ð´Ð¾Ð±Ð¸Ñ‚ÑŒÑÑ. Ð¡Ñ‚Ð°Ñ€Ð¸Ðº Ð¿Ñ€Ð¸Ð²Ñ‘Ð» ÐÐ»Ð¸ÑÑƒ Ðº ÐºÐ¾Ð¼Ð°Ð½Ð´Ð½Ð¾Ð¼Ñƒ Ð¿ÑƒÐ½ÐºÑ‚Ñƒ Ð½ÐµÐ¿Ð¾Ð´Ð°Ð»Ñ‘ÐºÑƒ Ð¸ Ð¿Ð¾Ð¼Ð¾Ð³ ÐµÐ¹ Ð¿Ñ€Ð¾Ð±Ñ€Ð°Ñ‚ÑŒÑÑ Ð½ÐµÐ·Ð°Ð¼ÐµÑ‚Ð½Ð¾ Ðº Ð·Ð°Ð²ÐµÑ‚Ð½Ð¾Ð¼Ñƒ Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð»Ñƒ. Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð²ÑÑ‘ Ð·Ð°Ð²Ð¸ÑÐµÐ»Ð¾ Ð¾Ñ‚ Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð² ÐÐ»Ð¸ÑÑ‹. ÐŸÐµÑ€ÐµÐ´ Ð½ÐµÐ¹ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð»Ð° [Ð¿Ð°Ð½ÐµÐ»ÑŒ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ](https://ship-control.vkactf.ru), Ð¾ÑÐ¾Ð±Ñ‹Ð¹ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ðº ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¹ Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ñ€Ð¸Ð²Ð¸Ð»ÐµÐ³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ð¼Ñƒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ. Ð”ÐµÐ¹ÑÑ‚Ð²Ð¾Ð²Ð°Ñ‚ÑŒ Ð½Ð°Ð´Ð¾ Ð±Ñ‹ÑÑ‚Ñ€Ð¾, Ð¿Ð¾ÐºÐ° Ð½Ð¸ÐºÑ‚Ð¾ Ð½Ðµ Ð¿Ñ€Ð¸ÑˆÑ‘Ð».


### ÐŸÐ¾ÑÑ‚Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ
> Ð’Ð¾Ð¹Ð´Ñ Ð² Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð», ÐÐ»Ð¸ÑÐµ Ð½Ð¸Ñ‡ÐµÐ³Ð¾ Ð½Ðµ Ð¼ÐµÑˆÐ°Ð»Ð¾ Ð²Ð½ÐµÑÑ‚Ð¸ Ð²ÑÐµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð»Ñ Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¸Ñ Ð¿Ð¾Ð»Ñ‘Ñ‚Ð°. ÐŸÐ¾ÑÐ»Ðµ Ð¾Ð½Ð° Ð½ÐµÐ·Ð°Ð¼ÐµÑ‚Ð½Ð¾ Ð²Ñ‹Ð±Ñ€Ð°Ð»Ð°ÑÑŒ Ð¾Ñ‚Ñ‚ÑƒÐ´Ð°, Ð¸ Ñ€Ð°Ð´Ð¾ÑÑ‚Ð½Ð°Ñ Ð¿Ð¾Ð¼Ñ‡Ð°Ð»Ð°ÑÑŒ Ðº Ð´Ð¾Ð¼Ñƒ Ð´Ñ€ÑƒÐ³Ð° Ð¾Ñ‚Ñ†Ð°. ÐŸÐµÑ€ÐµÐ´ Ð¾Ñ‚Ð»Ñ‘Ñ‚Ð¾Ð¼ Ð¾Ð½Ð° Ð¿Ð¾Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ð¸Ð»Ð° ÐµÐ³Ð¾.

### Ð ÐµÑˆÐµÐ½Ð¸Ðµ
![](images/main.jpg)

ÐÐ° ÑÐ°Ð¹Ñ‚Ðµ ÐµÑÑ‚ÑŒ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð°. Ð¡ÐµÐ°Ð½Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑÑ Ð² JWT Ñ‚Ð¾ÐºÐµÐ½Ðµ. Ð’ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ðµ Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ ÑÐºÑ€Ñ‹Ñ‚ Ð½ÐµÐºÐ¸Ð¹ Ñ‚Ð¾ÐºÐµÐ½ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°. ÐÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ ÑÑ‚Ð°Ñ‚ÑŒ Ð°Ð´Ð¼Ð¸Ð½Ð¾Ð¼ Ð´Ð»Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð° ÑÐºÑ€Ñ‹Ñ‚Ð¾Ð¹ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸

Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº JWT Ñ‚Ð¾ÐºÐµÐ½Ð° ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ð¿ÑƒÑ‚ÑŒ Ð´Ð¾ Ñ„Ð°Ð¹Ð»Ð° Ñ ÑÐµÐºÑ€ÐµÑ‚Ð½Ñ‹Ð¼ ÐºÐ»ÑŽÑ‡Ð¾Ð¼:
```json
{"typ":"JWT","alg":"HS256","kid":"keys/secret.key"}
```
Ð¢ÐµÐ»Ð¾ Ñ‚Ð¾ÐºÐµÐ½Ð° ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾ Ð¿Ñ€Ð¸Ð²Ð¸Ð»ÐµÐ³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾ÑÑ‚Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ:
```json
{"username":"alice","admin":false}
```
Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑ ÑÑ‚Ñƒ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¼Ñ‹ Ð¼Ð¾Ð¶ÐµÐ¼ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð² Ñ‚ÐµÐ»Ðµ Ñ‚Ð¾ÐºÐµÐ½Ð° `false` Ð½Ð° `true`:
```json
{"username":"alice","admin":true}
```
 Ð° Ð¿Ð¾Ð´Ð¿Ð¸ÑÐ°Ñ‚ÑŒ ÐµÐ³Ð¾ Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ñ‹Ð¼ Ñ„Ð°Ð¹Ð»Ð¾Ð¼, Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ñ„Ð°Ð¹Ð»Ð¾Ð¼ ÑÑ‚Ð¸Ð»ÐµÐ¹ Ð»Ð¸Ð±Ð¾ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸ÐµÐ¼, ÑƒÐºÐ°Ð·Ð°Ð² ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ð¹ Ð¿ÑƒÑ‚ÑŒ Ð´Ð¾ Ñ„Ð°Ð¹Ð»Ð° Ð² Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐµ Ñ‚Ð¾ÐºÐµÐ½Ð°:
```json
{"typ":"JWT","alg":"HS256","kid":"static/css/terminal.min.css"}
```
Ð—Ð°Ñ…Ð¾Ð´Ð¸Ð¼ Ð² Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ Ð¸ Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ñ„Ð»Ð°Ð³

**Ð¤Ð»Ð°Ð³:**

> vka{51mpl3_xp47h_vuln3r4b1l17y}