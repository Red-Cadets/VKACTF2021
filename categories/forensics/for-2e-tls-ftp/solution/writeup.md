## Секреты протоколов

| Событие | Название | Категория | Сложность |
| :------ | ---- | ---- | ---- |
| VKA-CTF`2021 | Секреты протоколов | Forensics | Easy |

### Описание

> Автор: WaffeSoul
>
> У коммунистов на Земле почти вся сеть закрыта их собственным RedWall'ом, так что доступ к их сервисам разрешен только по доверенным IP-адресам. Мы воспользовались нашим агентом, чтобы перехватить внутренний трафик прямо из их штаба. Осталось изучить его содержимое и извлечить все секреты командования красных.

### Решение

Дан pcap. Анализируем его порты. Нет http, много tls и порта 9090. Для расшифровки tls нужны ключи, поэтому его сейчас смотреть нет смысла. Смотрим чистый tcp. Обращаем внимание на порт 9090, большое количество запрос в payload данные похоже на base64. Также в начале есть переписка между 2 пользователями в которой говориться о логах. 
Достаем с помощью scpay base либо через стрим в wireshark.
>python2 exploit.py

Декодим base64. 
>cat log | base64 -d > log.log

Гуглим что это. Узнаем, что это логи логи java.
Ищем как с помощью логов Java раздекодить трафик tls, находи [ссылку](https://habr.com/ru/post/254205/), как раз описание нашего случая. Скачиваем [NssJavaMaker](https://habr.com/ru/post/254205/) и получаем ключи для wireshark.
>java -jar nssjavamaker.jar test.log

Подключаем ключи к wireshark и экспортируем все файлы http. Получаем 4 картинки в одной флаг.
 
**Флаг:**

> vka{no_secrets_only_memes_comrades_capitalists}