## Собирая по крупицам

| Событие | Название | Категория | Сложность |
| :------ | ---- | ---- | ---- |
| VKA-CTF`2021 | Чёрный ящик| For | Easy |

***

> Автор: Pashkevich
>
> Дано: mem.raw [скачать](https://disk.yandex.ru/d/xYbU9NWHDmvfjA)
>
> **Пароль**: TEp8gR3zkdQ3Ljpur8fPuUF4KcJkK2vD
>
> Недавно у пояса астероидов произошёл трагичный случай - какой-то корабль пытался обойти КПП и самостоятельно пройти пояс астероидов, чтобы не платить пошлины. В результате неудачного манёвра он, как и следовало ожидать, разбился. Нашими роботами было обследовано место крушения и извлечен черный ящик. Как выяснилось позднее, это был корабль-разведчик корпорации Космос Х. Теперь необходимо изучить полученные данные. Основная проблема - космокорпораты используют свою систему, так что наши модули не могут ее распознать. Разберетесь?

### Решение
Определяем ОС, с которой снят дамп. Volatility с параметром imageinfo не сможет распознать образ, поэтому необходимо использовать 010 Editor. Изучая дамп можно неоднократно встретить упоминание MacOS.
Теперь необходимо узнать, какой профиль необходим:
`python vol.py -f mem.raw mac_get_profile`

Получив необходимый профиль выполняем стандартные процедуры анализа дампов. Флаг хранится на рабочем столе в файле **flag.txt**.
Для его извлечения необходимо получить список файлов в системе и выполнить извлечение необходимого файла по смещению **0xffffff80207812e8**:
```
python vol.py -f mem.raw --profile=MacSierra_10_12_6_16G23ax64 mac_list_files
python vol.py -f mem.raw --profile=MacSierra_10_12_6_16G29x64 mac_dump_file -q  0xffffff80207812e8 -O flag.txt
```


Полученный файл является RTF документом (`{\rtf1\ansi\ansicpg1251\cocoartf1504\cocoasubrtf830`) . Меняем расширение и открываем файл.
В глаза бросается форматная строка, похожая на искомое: **ixn{npu1ri3z3ag_erprvirq:v_y0ir_znp}**

Применив расшифровку шифра Цезаря получим необходимый флаг.
### FLAG
vka{ach1ev3m3nt_received:i_l0ve_mac}
